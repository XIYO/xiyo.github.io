#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# λ¬΄ν•λ£¨ν”„ λ°©μ§€: μ΄λ―Έ μ‹¤ν–‰ μ¤‘μ΄λ©΄ μΆ…λ£
if [ "$FRONTMATTER_UPDATE_RUNNING" = "1" ]; then
  echo "π”„ ν”„λ΅ νΈλ§¤ν„° μ—…λ°μ΄νΈκ°€ μ΄λ―Έ μ‹¤ν–‰ μ¤‘μ…λ‹λ‹¤. κ±΄λ„λλ‹λ‹¤."
  exit 0
fi

echo "π€ Running post-commit hook..."

# ν™κ²½λ³€μ μ„¤μ •ν•μ—¬ λ¬΄ν•λ£¨ν”„ λ°©μ§€
export FRONTMATTER_UPDATE_RUNNING=1

# λ§μ§€λ§‰ μ»¤λ°‹μ—μ„ λ³€κ²½λ λ§ν¬λ‹¤μ΄ νμΌλ“¤μ„ μ°Ύμ•„μ„ ν”„λ΅ νΈλ§¤ν„° μ—…λ°μ΄νΈ
if pnpm exec node scripts/update-frontmatter-postcommit.js; then
  echo "β… Post-commit frontmatter update completed."
else
  echo "β Post-commit frontmatter update failed."
fi

# ν™κ²½λ³€μ ν•΄μ 
unset FRONTMATTER_UPDATE_RUNNING
